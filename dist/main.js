(()=>{const e=document.querySelector("[data-items]"),t=document.querySelector("[data-item-form]"),a=document.querySelector("[data-item-input]"),n=document.querySelector("[data-item-name]"),d=document.getElementById("item-template"),l=(document.getElementById("show-all-item-template"),document.querySelector("[data-tasks]")),o=document.querySelector("[data-task-form]"),i=document.querySelector("[data-task-input]"),c=document.querySelector("[data-task-date-input]"),r=document.querySelector("[data-task-container]"),s=document.getElementById("task-template"),u="items",m="selectedItemId";let k=JSON.parse(localStorage.getItem(u))||[],y=localStorage.getItem(m);function S(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function f(){return k.find((e=>e.id===y))}function I(){S(e),k.forEach((t=>{const a=d.content.cloneNode(!0),n=a.querySelector("div"),l=a.querySelector("[data-item-id]"),o=a.querySelector("[data-item-text]"),i=a.querySelector("[data-item-delete]");l.dataset.itemId=t.id,o.textContent=t.name,t.id===y&&n.classList.add("active-item"),e.appendChild(a),i.addEventListener("click",(e=>{deleteItemId=e.target.closest("[data-item-id]").dataset.itemId,k=k.filter((e=>e.id!==deleteItemId)),deleteItemId==y&&(y=null),p()}))}));const t=f();null==y||null==t?r.style.display="none":(r.style.display="",function(){const e=f();n.innerText=null==e?"":e.name}(),S(l),function(e){e.tasks.forEach((t=>{const a=s.content.cloneNode(!0),n=a.querySelector("[data-task-id]"),d=a.querySelector("[data-task-text]"),o=a.querySelector("[data-task-date]"),i=a.querySelector("[data-task-checkbox]"),c=a.querySelector("[data-task-delete]");n.dataset.taskId=t.id,d.textContent=t.name,o.textContent=t.date,i.checked=t.complete,i.addEventListener("click",(()=>{i.checked,t.complete=!t.complete,p()})),l.appendChild(a),c.addEventListener("click",(t=>{deleteTaskId=t.target.closest("[data-task-id]").dataset.taskId,e.tasks=e.tasks.filter((e=>e.id!==deleteTaskId)),p()}))}))}(t))}function p(){localStorage.setItem(u,JSON.stringify(k)),localStorage.setItem(m,y),I()}e.addEventListener("click",(function(e){itemContainer=e.target.closest(".item"),null==e.target.closest("[data-item-delete]")&&"item"===itemContainer.classList.value&&(y=itemContainer.dataset.itemId),p()})),t.addEventListener("submit",(function(e){e.preventDefault();const t=a.value;if(!t||0===t.trim().length)return;const n=(d=t,{id:Date.now().toString(),name:d,tasks:[]});var d;a.value=null,k.push(n),p()})),o.addEventListener("submit",(function(e){e.preventDefault();const t=i.value,a=c.value;if(!t||0===t.trim().length)return;const n=(d=t,l=a,{id:Date.now().toString(),name:d,date:l,complete:!1});var d,l;i.value=null,c.value=null,f().tasks.push(n),p()})),I()})();